<html>

<head>
    <title>MidiWrite</title>

	<link rel="stylesheet" href="css/blueprint/reset.css" />
	<link rel="stylesheet" href="css/blueprint/typography.css" />
	<link rel="stylesheet" href="css/midiview.css" />

    <script src="lib/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="lib/underscore-min.js" type="text/javascript"></script>
    <script src="lib/backbone-min.js" type="text/javascript"></script>

	<script src="js/midi.reader.js" type="text/javascript"></script>
	<script src="js/midi.reader.lib.js" type="text/javascript"></script>
	<script src="js/midi.writer.js" type="text/javascript"></script>
	<script src="js/midi.util.stream.js" type="text/javascript"></script>

	<script src="js/midi.enums.notes.js" type="text/javascript"></script>
	<script src="js/midi.enums.percussion.js" type="text/javascript"></script>
	<script src="js/midi.enums.instruments.js" type="text/javascript"></script>
	<script src="js/midi.enums.controllers.js" type="text/javascript"></script>
	<script src="js/midi.enums.events.js" type="text/javascript"></script>

	<script src="js/midi.views.event.js" type="text/javascript"></script>
	<script src="js/midi.views.info.js" type="text/javascript"></script>
</head>

<body>
	<div class="column">

		<table class="events">
			<thead>
                <th width="30">&#916;</th>
				<th width="15">T</th>
				<th width="15">C</th>
				<th width="60">Type</th>								
				<th width="30">Data</th>
				<th width="70"></th>
			</thead>
		</table>
	</div>

	<div class="column">
		<div class="info">
			<label>File Name:</label><span class="fileName"></span><br/>
			<label>Format:</label><span class="formatType"></span>
			<label>Tracks:</label><span class="trackCount"></span>
			<label>Time:</label><span class="timeSig"></span><br/>
			<label>BeatsPerMin:</label><span class="beatsPerMin"></span>
			<label>TicksPerBeat:</label><span class="ticksPerBeat"></span></br>
			<label>McsPerBeat:</label><span class="mcsPerBeat"></span>
			<label>TicksPerMin:</label><span class="ticksPerMin"></span></br>
			<label>McsPerTick:</label><span class="mcsPerTick"></span>
			<label>MlsPerTick:</label><span class="mlsPerTick"></span>
		</div>
	</div>
</body>

<script type="text/javascript">

    $(function () {

		//var events = Midi.Enums.Events;
		//var notes = {c4:60 };

        var infoView = new Midi.Views.InfoView({ el: ".info" })
        var eventView = new Midi.Views.EventView({ el: ".events" });

		var midiIn = {
			header: {formatType:1, ticksPerBeat:240},
			tracks: []
		};

		var track = [
            
			{ type: 'sequence-number', number: 1 },
			
			{ type: 'text',       text: "Powered by Midio" },
			{ type: 'copyright',  text: "JSFanatic" },
			{ type: 'track-name', text: "Love Wrangler" },
			{ type: 'instrument', text: "Keyboard" },
            
			{ type: 'lyrics',     text: "Ohh baby yeah..." },
			{ type: 'marker',     text: "Intro" },
			{ type: 'cue-point',  text: "Dancers" },

			{ type: 'tempo', mcsPerBeat: 400000 },
			{ type: 'time-signature', numerator: 6, denominator: 8, metronome: 24, thirtyseconds: 8 },

			{ type: 'note-on',  time: 0,   channel: 0, note: 60, velocity: 90 },
			{ type: 'note-off', time: 128, channel: 0, note: 60, velocity: 90 },

			//{ type: 'note-on', time:0, channel:0, note: 'C4', velocity:90},
			//{ type: 'note-off', time:128, channel:0, note: 'V4', velocity:90},

			{ type: 'controller', time: 0, channel: 0, controller: 7, value: 128 },
			{ type: 'note-aftertouch', time: 0, channel: 0, note: 62, value: 64 },
			{ type: 'program', time: 0, channel: 0, value: 36},
			{ type: 'channel-aftertouch', time: 0, channel: 0, value: 127},
			{ type: 'channel-prefix', time: 0, channel: 10},
		];

		//console.log(track);
		midiIn.tracks.push(track);

		var hex = Midi.Writer.write(midiIn);
		var midi = Midi.Reader.loadBinary(hex)

		//console.log(midi);

		// view
        infoView.render(midi);
        eventView.render(midi);
        //console.log(btoa(hex));

    });

</script>


</html>