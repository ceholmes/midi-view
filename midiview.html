<html>

<head>
    <title>MidiView</title>

	<link rel="stylesheet" href="css/blueprint/reset.css" />
	<link rel="stylesheet" href="css/blueprint/typography.css" />
	<link rel="stylesheet" href="css/midiview.css" />

    <script src="lib/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="lib/underscore-min.js" type="text/javascript"></script>
    <script src="lib/backbone-min.js" type="text/javascript"></script>

    <script src="js/midi.reader.js" type="text/javascript"></script>
    <script src="js/midi.reader.lib.js" type="text/javascript"></script>
	<script src="js/midi.util.stream.js" type="text/javascript"></script>

	<script src="js/midi.enums.notes.js" type="text/javascript"></script>
	<script src="js/midi.enums.percussion.js" type="text/javascript"></script>
	<script src="js/midi.enums.instruments.js" type="text/javascript"></script>
	<script src="js/midi.enums.controllers.js" type="text/javascript"></script>

	<script src="js/midi.views.event.js" type="text/javascript"></script>
	<script src="js/midi.views.info.js" type="text/javascript"></script>
</head>

<body>

	<input type="file" id="files" />

	<div class="buttons">
		<button class="Open"><img src="images\folder.gif"/>Open</button>
	</div>

	<div class="column">

		<table class="events">
			<thead>
                <th width="30">&#916;</th>
				<th width="15">T</th>
				<th width="15">C</th>
				<th width="60">Type</th>								
				<th width="40">Data</th>
				<th width="40"></th>
			</thead>
		</table>
	</div>

	<div class="column">

		<div class="info">
			<label>File Name:</label><span class="fileName"></span><br/>
			<label>Format:</label><span class="formatType"></span>
			<label>Tracks:</label><span class="trackCount"></span>
			<label>Time:</label><span class="timeSig"></span><br/>
			<label>BeatsPerMin:</label><span class="beatsPerMin"></span>
			<label>TicksPerBeat:</label><span class="ticksPerBeat"></span></br>
			<label>McsPerBeat:</label><span class="mcsPerBeat"></span>
			<label>TicksPerMin:</label><span class="ticksPerMin"></span></br>
			<label>McsPerTick:</label><span class="mcsPerTick"></span>
			<label>MlsPerTick:</label><span class="mlsPerTick"></span>
		</div>

		<div class="options">
			<input id="types.meta" type="checkbox" checked="checked"/>
			<label for="types.meta">Meta</label>

			<input id="types.channel" type="checkbox" checked="checked"/>
			<label for="types.channel">channel</label></br>

			<input id="events.note-on" type="checkbox" checked="checked"/>
			<label for="events.note-on">Note On</label>

			<input id="events.note-off" type="checkbox" checked="checked"/>
			<label for="events.note-off">Note Off</label>
		</div>
	</div>

	<script type="text/javascript">

	    $(function () {

			var infoView = new Midi.Views.InfoView({el: ".info"})

			var eventView = new Midi.Views.EventView({
				el: ".events",
			});

			$(".open").click(function(){
				$("input[type='file']").click();
			});

	        $("#files").change(function(evt){

				var file = evt.target.files[0];

				Midi.Reader.loadFile(file, function(midi){
					infoView.render(midi);
					eventView.render(midi);
				})

			});

			$(".options input[type='checkbox']").click(function(){

				var option = $(this).attr("id").split(".");
				var value = $(this).is(":checked");

				eventView.options[option[0]][option[1]] = value;
				eventView.render();
			});
	    });

	</script>

</body>

</html>