<!--
http://developer.apple.com/library/mac/#documentation/QuickTime/Conceptual/QTScripting_HTML/QTScripting_HTML_Document/ScriptingHTML.html#//apple_ref/doc/uid/TP40001525-2-HTMLScripting
http://developer.apple.com/library/safari/#documentation/QuickTime/Conceptual/QTScripting_JavaScript/bQTScripting_JavaScri_Document/QuickTimeandJavaScri.html#//apple_ref/doc/uid/TP40001526-CH001-SW1
-->

<html>

<head>
	<script src="lib/jquery-1.7.2.min.js" type="text/javascript"></script>
	
</head>

<body>
	<input type="file" id="files" />
	
	<div class="buttons">
		<button class="stop">stop</button>
		<button class="play">play</button>
	</div>
	

	<!--
	<OBJECT classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" codebase="http://www.apple.com/qtactivex/qtplugin.cab" width="0" height="0" id="midi1" autostart="false">	 
		<PARAM name="src" value="mid\kebu.mid"">	 
		<EMBED HEIGHT="0" WIDTH="0" SRC="mid\kebu.mid" TYPE="video/quicktime" PLUGINSPAGE="www.apple.com/quicktime/download" EnableJavaScript="true" NAME="midi1" autostart="false"/>	 
	</OBJECT>	
	-->
	
	<!--
	<OBJECT classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" codebase="http://www.apple.com/qtactivex/qtplugin.cab" width="0" height="0" id="midi1" autostart="false">	 		
		<EMBED HEIGHT="0" WIDTH="0" SRC="mid\kebu.mid" TYPE="video/quicktime" PLUGINSPAGE="www.apple.com/quicktime/download" EnableJavaScript="true" NAME="midi1" autostart="false"/>	 
	</OBJECT>	
	-->
	
	<EMBED id="midi1" HEIGHT="0" WIDTH="0" SRC="mid\kebu.mid" TYPE="video/quicktime" EnableJavaScript="true" NAME="midi1" autostart="false"/>	 
	
	<script type="text/javascript">

	$(function () {
		
		
		
		$("#files").change(function(evt){
			
			var file = evt.target.files[0];
			
			console.log(file);
								
			var reader = new FileReader();
							
			reader.onloadend = function(){
				document.midi1.SetURL(this.result);			
			}
			
			reader.readAsDataURL(file);
			
			//document.midi1.SetURL(file);
			//document.midi1.Play();
		});;
		
		
		
		$(".play").click(function(){			
			document.midi1.Play();
		});

		$(".stop").click(function(){
			document.midi1.Stop();
		});
		
		
		function MidiPlayer(options){
		
			var quicktime;
		
			this.load = function(file){				
				
				$("#midi1").remove();
				//delete document.midi1;
				
				var tag = "<EMBED id='midi1' HEIGHT='0 WIDTH='0' SRC='" + file + "' TYPE='video/quicktime' EnableJavaScript='true' NAME='midi1' autostart='false'/>";
				
				$(document).append(tag);
				quicktime = document.getElementById("midi1");
				
				//document.write(tag)
				//quicktime = document.getElementById(midi1);				
			};
			
			this.play = function(){
				quicktime.Play();
			};
			
			this.pause = function(){
				quicktime.Stop();
			};
			
			this.stop = function(){
				quicktime.Stop();
			};
			
			return this;
		}

		var player = new MidiPlayer();
		
	});

	</script>
</body>	


</html>